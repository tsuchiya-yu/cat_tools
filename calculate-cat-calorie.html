<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>çŒ«ã®ã‚«ãƒ­ãƒªãƒ¼è¨ˆç®—ï½œä½“é‡ã‹ã‚‰1æ—¥ã®å¿…è¦ã‚«ãƒ­ãƒªãƒ¼ã‚’è‡ªå‹•è¨ˆç®—</title>
  <meta name="description" content="ä½“é‡ã¨ã„ãã¤ã‹ã®ç°¡å˜ãªé¸æŠã ã‘ã§ã€çŒ«ã®1æ—¥ã®å¿…è¦ã‚«ãƒ­ãƒªãƒ¼ï¼ˆkcal/æ—¥ï¼‰ã‚’è‡ªå‹•è¨ˆç®—ã€‚çµæœã¯ä¸­å¿ƒå€¤ã¨å‚è€ƒå¹…ã§è¡¨ç¤ºã—ã¾ã™ã€‚">
  <link rel="canonical" href="https://cat-tools.catnote.tokyo/calculate-cat-calorie">

  <!-- OGPï¼ˆå¾Œã§å·®ã—æ›¿ãˆå¯ï¼‰ -->
  <meta property="og:title" content="çŒ«ã®ã‚«ãƒ­ãƒªãƒ¼è¨ˆç®—">
  <meta property="og:description" content="ä½“é‡ã‹ã‚‰çŒ«ã®1æ—¥ã®å¿…è¦ã‚«ãƒ­ãƒªãƒ¼ã‚’è‡ªå‹•è¨ˆç®—ã€‚çµæœã¯ä¸­å¿ƒå€¤ï¼‹å‚è€ƒå¹…ã§è¡¨ç¤ºã€‚">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://cat-tools.catnote.tokyo/og-cat-calorie.png">
  <meta property="og:locale" content="ja_JP">
  <meta name="twitter:card" content="summary_large_image">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Zen+Kaku+Gothic+New:wght@400..700&family=Outfit:wght@600;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --primary:#FF69B4; --primary-strong:#E00070;
      --text:#111; --muted:#666; --border:#E9E9EA;
      --r-sm:8px; --r-md:12px; --r-lg:16px; --r-xl:24px;
      --s-1:8px; --s-2:16px; --s-3:24px; --s-4:40px;
      --ring:0 0 0 2px rgba(224,0,112,.35);
    }
    *,*::before,*::after{ box-sizing:border-box }
    html,body{ height:100% }
    body{
      margin:0; background:#fff; color:var(--text);
      font-family:"Zen Kaku Gothic New","Noto Sans JP",-apple-system,system-ui,Segoe UI,Meiryo,sans-serif;
      -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    }
    .container{ max-width:760px; margin:0 auto; padding:0 var(--s-3) var(--s-4) }

    .eyebrow{ font-size:14px; letter-spacing:.08em; text-transform:uppercase; color:rgba(224,0,112,.85); margin-top:var(--s-3) }
    h1{ font-size:32px; line-height:1.25; font-weight:700; margin:.4rem 0 0 }
    @media (min-width:768px){ h1{ font-size:40px; line-height:1.2 } }
    .lead{ font-size:14px; color:var(--muted); margin:.6rem 0 var(--s-3); line-height:1.7 }
    .section{ margin-top:var(--s-4) }
    .label{ font-size:18px; font-weight:700; color:#111 }

    /* å…¥åŠ›ã‚¨ãƒªã‚¢ï¼šä¸‹ç·šã§åŒºåˆ‡ã‚Š */
    .surface{
      padding:var(--s-3);
      border:none; border-radius:0;
      border-bottom:1px solid var(--border);
      overflow:hidden;
    }
    .row{ display:flex; flex-direction:column; gap:var(--s-2); margin-top:var(--s-2) }

    input[type="number"]{
      width:100%; height:56px; padding:0 var(--s-3);
      border:2px solid #F0C7D8; border-radius:var(--r-xl);
      font-size:16px; color:var(--text); background:#fff;
    }
    input:focus-visible{ outline:none; box-shadow:var(--ring) }
    .help{ font-size:13px; color:#808080; margin-top:4px }

    /* ã‚»ã‚°ãƒ¡ãƒ³ãƒˆï¼ˆãƒœã‚¿ãƒ³åˆ‡æ›¿ï¼‰ */
    .seg{ display:flex; gap:8px; flex-wrap:wrap }
    .seg button{
      appearance:none; border:1px solid #E5E7EB; background:#fff; color:#111;
      padding:10px 14px; border-radius:999px; cursor:pointer; font-size:14px; font-weight:600;
    }
    .seg button[aria-pressed="true"]{
      border-color:var(--primary-strong); color:#fff; background:var(--primary-strong);
    }

    /* ãƒˆã‚°ãƒ« */
    .switch{ display:flex; align-items:center; gap:10px }
    .switch input{ appearance:none; width:44px; height:26px; border-radius:999px; background:#E5E7EB; position:relative; cursor:pointer; outline:none; border:none }
    .switch input::after{
      content:""; position:absolute; left:3px; top:3px; width:20px; height:20px; border-radius:50%; background:#fff; transition:left .15s ease;
      box-shadow:0 1px 2px rgba(0,0,0,.2);
    }
    .switch input:checked{ background:var(--primary-strong) }
    .switch input:checked::after{ left:21px }
    .switch label{ font-size:14px; color:#111 }

    /* çµæœè¡¨ç¤º */
    .result{ text-align:center; position:relative; padding-top:8px; padding-bottom:var(--s-3); border-bottom:1px solid var(--border) }
    .result .muted{ color:var(--muted); margin-bottom:6px; letter-spacing:.04em }
    .numeral{
      font-family:"Outfit",ui-sans-serif,system-ui,-apple-system,"Helvetica Neue",Arial,sans-serif;
      font-variant-numeric:tabular-nums; letter-spacing:-.01em;
    }
    .big{ display:flex; align-items:baseline; justify-content:center; gap:14px; font-size:0; flex-wrap:wrap }
    .age-group{ display:flex; align-items:baseline; gap:6px }
    .age-group .numeral{ font-size:72px; font-weight:800; color:var(--primary-strong) }
    .age-group .unit{ font-size:20px; color:#111; position:relative; top:-10px }
    @media (max-width:480px){
      .age-group .numeral{ font-size:56px }
      .age-group .unit{ font-size:18px; top:-8px }
    }

    .grid{ display:grid; grid-template-columns:repeat(3,1fr); gap:0; margin-top:18px }
    .cell{ background:transparent; border-left:1px solid #F0C7D8; padding:14px 16px }
    .cell:first-child{ border-left:none }
    .cell .k{ font-size:12px; text-transform:uppercase; letter-spacing:.04em; color:#808080; text-align:center }
    .cell .v{ font-weight:700; font-size:16px; text-align:center; margin-top:6px; word-break:keep-all }

    .error{ color:#b00020; font-size:13px; margin-top:6px; min-height:1.2em }

    /* å…±æœ‰ãƒœã‚¿ãƒ³ï¼‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼ */
    .share-btn{
      position:absolute; right:0; top:0; transform:translateY(-60%);
      width:40px; height:40px; border-radius:999px; border:1px solid #D7DADF;
      background:#fff; display:inline-grid; place-items:center; cursor:pointer;
    }
    .share-btn:hover{ border-color:#B7BBC3 }
    .share-menu{
      position:absolute; right:0; top:0; transform:translateY(-10%); z-index:20;
      background:#fff; border:1px solid #E5E7EB; border-radius:12px; box-shadow:0 8px 24px rgba(0,0,0,.08);
      padding:6px; display:none; min-width:220px;
    }
    .share-menu.open{ display:block }
    .share-item{
      display:flex; align-items:center; gap:10px; width:100%;
      padding:10px 12px; border-radius:8px; background:#fff; color:#111; text-decoration:none; cursor:pointer;
    }
    .share-item:hover{ background:#F8F9FB }
    .share-item svg{ flex-shrink:0 }

    .section-title{ margin-top:var(--s-4); padding-top:var(--s-2); border-top:1px solid var(--border); font-weight:800; font-size:24px; letter-spacing:-.01em }
    details{ border:none; border-top:1px solid #eee; padding:18px 0 }
    details+details{ margin-top:0 }
    summary{ list-style:none; cursor:pointer; display:flex; align-items:center; justify-content:space-between; font-weight:400; color:#111 }
    summary::-webkit-details-marker{ display:none }
    summary:hover{ color:var(--primary-strong) }
    .chev{ transition:transform .15s ease }
    details[open] .chev{ transform:rotate(180deg) }

    .toast{
      position:fixed; left:50%; bottom:24px; transform:translateX(-50%);
      background:#111; color:#fff; font-size:14px; padding:10px 14px; border-radius:10px;
      opacity:0; pointer-events:none; transition:opacity .18s ease;
    }
    .toast.show{ opacity:1 }

    footer{ color:#888; font-size:13px; margin-top:var(--s-4) }
    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0 }
  </style>
</head>
<body>
  <main class="container">
    <!-- Hero -->
    <section class="section">
      <p class="eyebrow">çŒ«ã®ã‚«ãƒ­ãƒªãƒ¼ã‚’ã‹ã‚“ãŸã‚“è¨ˆç®—</p>
      <h1>çŒ«ã®ã‚«ãƒ­ãƒªãƒ¼è¨ˆç®—</h1>
      <p class="lead">ä½“é‡ã¨ã„ãã¤ã‹ã®é¸æŠã ã‘ã§ã€1æ—¥ã®å¿…è¦ã‚«ãƒ­ãƒªãƒ¼ï¼ˆkcal/æ—¥ï¼‰ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚çµæœã¯ä¸­å¿ƒå€¤ã¨å‚è€ƒå¹…ã§å‡ºã‚‹ã®ã§ã€ã‚€ãšã‹ã—ã„è¨­å®šã¯ä¸è¦ã§ã™ã€‚</p>

      <div class="surface">
        <div class="label">å…¥åŠ›</div>
        <div class="row">
          <!-- ä½“é‡ -->
          <div>
            <label class="sr-only" for="w">ä½“é‡(kg)</label>
            <input id="w" type="number" step="0.1" min="0.5" placeholder="ä½“é‡ (kg)">
            <div class="help">ä¾‹: 4.2</div>
          </div>

          <!-- ãƒ©ã‚¤ãƒ•ã‚¹ãƒ†ãƒ¼ã‚¸ -->
          <div>
            <div class="help" style="margin-bottom:6px">ãƒ©ã‚¤ãƒ•ã‚¹ãƒ†ãƒ¼ã‚¸</div>
            <div class="seg" role="tablist" aria-label="ãƒ©ã‚¤ãƒ•ã‚¹ãƒ†ãƒ¼ã‚¸">
              <button id="st-kitten" class="seg-btn" data-stage="kitten" aria-pressed="false">å­çŒ«</button>
              <button id="st-adult"  class="seg-btn" data-stage="adult" aria-pressed="true">æˆçŒ«</button>
              <button id="st-senior" class="seg-btn" data-stage="senior" aria-pressed="false">ã‚·ãƒ‹ã‚¢</button>
            </div>
          </div>

          <!-- å»å‹¢/é¿å¦Šï¼ˆæˆçŒ«ã®ã¿è¡¨ç¤ºï¼‰ -->
          <div class="switch" id="neuteredWrap">
            <input id="neutered" type="checkbox" checked aria-label="å»å‹¢ãƒ»é¿å¦Šæ¸ˆã¿">
            <label for="neutered">å»å‹¢/é¿å¦Šæ¸ˆã¿ï¼ˆæˆçŒ«ã®ã¿ï¼‰</label>
          </div>

          <!-- ç›®æ¨™ -->
          <div>
            <div class="help" style="margin-bottom:6px">ç›®æ¨™</div>
            <div class="seg" role="tablist" aria-label="ç›®æ¨™">
              <button id="gl-maintain" class="seg-btn" data-goal="maintain" aria-pressed="true">ç¶­æŒ</button>
              <button id="gl-loss"     class="seg-btn" data-goal="loss" aria-pressed="false">æ¸›é‡ã—ãŸã„</button>
              <button id="gl-gain"     class="seg-btn" data-goal="gain" aria-pressed="false">å¢—é‡ã—ãŸã„</button>
            </div>
          </div>
        </div>

        <div id="error" class="error" role="alert" aria-live="polite"></div>
      </div>
    </section>

    <!-- Result -->
    <section id="resultSection" class="section" aria-live="polite">
      <div class="result">
        <div class="muted">1æ—¥ã®å¿…è¦ã‚«ãƒ­ãƒªãƒ¼</div>

        <div class="big">
          <span class="age-group">
            <span id="kcal" class="numeral">--</span><span class="unit">kcal/æ—¥</span>
          </span>
        </div>

        <!-- å…±æœ‰ãƒœã‚¿ãƒ³ -->
        <button id="shareBtn" class="share-btn" aria-haspopup="menu" aria-expanded="false" aria-label="å…±æœ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ã">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#69707D" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M4 12v7a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1v-7"/><path d="M12 16V4"/><path d="M8 8l4-4 4 4"/>
          </svg>
        </button>
        <div id="shareMenu" class="share-menu" role="menu" aria-label="å…±æœ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼"></div>

        <div class="grid">
          <div class="cell"><div class="k">å‚è€ƒå¹…</div><div id="range" class="v">â€”</div></div>
          <div class="cell"><div class="k">ä¿‚æ•°</div><div id="factor" class="v">â€”</div></div>
          <div class="cell"><div class="k">è¨ˆç®—ã«ä½¿ã£ãŸå¼</div><div id="formula" class="v">RER=70Ã—ä½“é‡^0.75</div></div>
          <div class="cell" style="grid-column:1/-1"><div class="k">ãƒ¡ãƒ¢</div><div id="note" class="v">â€”</div></div>
        </div>
      </div>
    </section>

    <!-- FAQï¼ˆå¸¸æ™‚è¡¨ç¤ºï¼‰ -->
    <section class="section" aria-labelledby="faqTitle">
      <h2 id="faqTitle" class="section-title">ã‚ˆãã‚ã‚‹è³ªå•</h2>
      <div>
        <details>
          <summary>ã©ã†ã‚„ã£ã¦è¨ˆç®—ã—ã¦ã„ã‚‹ã®ï¼Ÿ <svg class="chev" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#444" stroke-width="1.5"><path d="M6 9l6 6 6-6"/></svg></summary>
          <div class="muted" style="margin-top:8px">
            ä½“é‡ã‹ã‚‰RERï¼ˆå®‰é™æ™‚å¿…è¦é‡ï¼‰=<code>70 Ã— ä½“é‡^0.75</code>ã‚’å‡ºã—ã€<b>ãƒ©ã‚¤ãƒ•ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ»ç›®æ¨™ãƒ»å»å‹¢ã®æœ‰ç„¡</b>ã«å¿œã˜ãŸä¿‚æ•°ã‚’æ›ã‘ã¦1æ—¥ã®å¿…è¦ã‚«ãƒ­ãƒªãƒ¼ã‚’æ±‚ã‚ã¾ã™ã€‚<br>
            ã‚€ãšã‹ã—ã„å°‚é–€è¨­å®šã¯ãªã—ã€‚ã‹ã‚ã‚Šã«<strong>ä¸­å¿ƒå€¤ï¼‹å‚è€ƒå¹…</strong>ã‚’å‡ºã—ã¦ã€ä½“æ ¼å·®ã‚„ç”Ÿæ´»ã®å·®ã‚’å¸åã—ã¾ã™ã€‚
          </div>
        </details>
        <details>
          <summary>å‚è€ƒå¹…ã£ã¦ä½•ï¼Ÿã©ã†ä½¿ã†ã®ï¼Ÿ <svg class="chev" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#444" stroke-width="1.5"><path d="M6 9l6 6 6-6"/></svg></summary>
          <div class="muted" style="margin-top:8px">
            ä½“æ ¼ï¼ˆã‚„ã›æ°—å‘³/å¤ªã‚Šæ°—å‘³ï¼‰ã‚„æ´»å‹•é‡ã®é•ã„ã§ã€å¿…è¦ã‚«ãƒ­ãƒªãƒ¼ã¯å¢—æ¸›ã—ã¾ã™ã€‚ãã®å¹…ã‚’ã‚ã‚‰ã‹ã˜ã‚è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚<br>
            ã¾ãšã¯<strong>ä¸­å¿ƒå€¤</strong>ã§å§‹ã‚ã€<b>é€±1ã€œ2å›ã®ä½“é‡è¨˜éŒ²</b>ã‚’ã€‚å¢—ãˆç¶šã‘/æ¸›ã‚Šç¶šã‘ã‚‹å ´åˆã¯<strong>5ã€œ10%</strong>ãšã¤ä¸Šä¸‹ã—ã¦èª¿æ•´ã—ã¾ã—ã‚‡ã†ã€‚
          </div>
        </details>
        <details>
          <summary>å»å‹¢/é¿å¦Šã¯ã©ã‚“ãªå½±éŸ¿ãŒã‚ã‚‹ï¼Ÿ <svg class="chev" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#444" stroke-width="1.5"><path d="M6 9l6 6 6-6"/></svg></summary>
          <div class="muted" style="margin-top:8px">
            æˆçŒ«ã§ã¯ä¸€èˆ¬ã«ã€<b>æœªå»å‹¢</b>ã‚ˆã‚Š<b>å»å‹¢/é¿å¦Šæ¸ˆã¿</b>ã®ã»ã†ãŒå¿…è¦ã‚«ãƒ­ãƒªãƒ¼ãŒä½ããªã‚ŠãŒã¡ã§ã™ï¼ˆä¿‚æ•°ã®ç›®å®‰ï¼šæœªå»å‹¢1.4ã€å»å‹¢æ¸ˆ1.2ï¼‰ã€‚<br>
            æœ¬ãƒ„ãƒ¼ãƒ«ã§ã¯æˆçŒ«ã®ã¨ãã ã‘ãƒˆã‚°ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã€ä¸­å¿ƒå€¤ã¨å‚è€ƒå¹…ã«åæ˜ ã•ã‚Œã¾ã™ã€‚
          </div>
        </details>
      </div>
    </section>

    <footer class="section">Â© <span id="year"></span> CAT LINK tools</footer>
  </main>

  <!-- FAQ æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ï¼ˆç°¡æ˜“ï¼‰ -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {"@type":"Question","name":"ã©ã†ã‚„ã£ã¦è¨ˆç®—ã—ã¦ã„ã‚‹ã®ï¼Ÿ","acceptedAnswer":{"@type":"Answer","text":"ä½“é‡ã‹ã‚‰RER=70Ã—ä½“é‡^0.75ã‚’å‡ºã—ã€ãƒ©ã‚¤ãƒ•ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ»ç›®æ¨™ãƒ»å»å‹¢ã®æœ‰ç„¡ã«å¿œã˜ãŸä¿‚æ•°ã‚’æ›ã‘ã¦1æ—¥ã®å¿…è¦ã‚«ãƒ­ãƒªãƒ¼ã‚’æ±‚ã‚ã¾ã™ã€‚å°‚é–€è¨­å®šã¯ä¸è¦ã§ã€ä¸­å¿ƒå€¤ï¼‹å‚è€ƒå¹…ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚"}},
      {"@type":"Question","name":"å‚è€ƒå¹…ã£ã¦ä½•ï¼Ÿã©ã†ä½¿ã†ã®ï¼Ÿ","acceptedAnswer":{"@type":"Answer","text":"ä½“æ ¼ã‚„æ´»å‹•é‡ã®é•ã„ã§å¿…è¦ã‚«ãƒ­ãƒªãƒ¼ã¯å¢—æ¸›ã—ã¾ã™ã€‚ãã®å¹…ã‚’ã‚ã‚‰ã‹ã˜ã‚è¡¨ç¤ºã€‚ã¾ãšã¯ä¸­å¿ƒå€¤ã§å§‹ã‚ã€é€±1ã€œ2å›ã®ä½“é‡è¨˜éŒ²ã‚’è¡Œã„ã€5ã€œ10%ãšã¤å¾®èª¿æ•´ã—ã¾ã—ã‚‡ã†ã€‚"}},
      {"@type":"Question","name":"å»å‹¢/é¿å¦Šã¯ã©ã‚“ãªå½±éŸ¿ãŒã‚ã‚‹ï¼Ÿ","acceptedAnswer":{"@type":"Answer","text":"æˆçŒ«ã§ã¯ä¸€èˆ¬ã«æœªå»å‹¢ã‚ˆã‚Šå»å‹¢/é¿å¦Šæ¸ˆã¿ã®ã»ã†ãŒå¿…è¦ã‚«ãƒ­ãƒªãƒ¼ãŒä½ã‚ï¼ˆä¿‚æ•°ç›®å®‰ï¼šæœªå»å‹¢1.4ã€å»å‹¢æ¸ˆ1.2ï¼‰ã€‚ãƒˆã‚°ãƒ«ã¯æˆçŒ«æ™‚ã®ã¿è¡¨ç¤ºã•ã‚Œã€ä¸­å¿ƒå€¤ã¨å‚è€ƒå¹…ã«åæ˜ ã—ã¾ã™ã€‚"}}
    ]
  }
  </script>

  <script>
    // ===== ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ =====
    const $ = (s)=>document.querySelector(s);
    $('#year').textContent = String(new Date().getFullYear());
    const toast = document.createElement('div'); toast.className='toast'; document.body.appendChild(toast);
    function showToast(msg){ toast.textContent=msg; toast.classList.add('show'); setTimeout(()=>toast.classList.remove('show'), 1600); }

    // ===== å…¥åŠ›å‚ç…§ =====
    const w = $('#w');
    const segStageBtns = document.querySelectorAll('.seg-btn[data-stage]');
    const segGoalBtns  = document.querySelectorAll('.seg-btn[data-goal]');
    const neuteredWrap = $('#neuteredWrap');
    const neutered = $('#neutered');
    const errEl = $('#error');

    // ===== å‡ºåŠ›å‚ç…§ =====
    const kcalEl = $('#kcal'), rangeEl = $('#range'), factorEl = $('#factor'), noteEl = $('#note');

    // ===== å…±æœ‰ =====
    const shareBtn = $('#shareBtn'), shareMenu = $('#shareMenu');
    shareBtn.addEventListener('click', (e)=>{ e.stopPropagation(); toggleShare(); });
    document.addEventListener('click', (e)=> {
      if (!shareMenu.contains(e.target) && e.target !== shareBtn) toggleShare(false);
    });
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') toggleShare(false); });

    function iconX(){ return `<svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M18.2 3h2.4l-5.2 5.9L22 21h-4.8l-3.7-7-4.2 4.8V21H4V3h5.3v7.5L18.2 3z"/></svg>`;}
    function iconShare(){ return `<svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M4 12v7a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1v-7"/><path d="M12 16V4"/><path d="M8 8l4-4 4 4"/></svg>`;}
    function iconLink(){ return `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" aria-hidden="true"><path d="M10 13a5 5 0 0 1 0-7l1.5-1.5a5 5 0 0 1 7 7L17 12"/><path d="M14 11a5 5 0 0 1 0 7L12.5 19.5a5 5 0 1 1-7-7L7 12"/></svg>`;}

    function buildShareMenu(){
      shareMenu.innerHTML = '';
      const url = new URL(location.href).toString();
      const k = kcalEl.textContent;
      const r = rangeEl.textContent;
      const text = (k !== '--' && r !== 'â€”')
        ? `ã†ã¡ã®çŒ«ã®å¿…è¦ã‚«ãƒ­ãƒªãƒ¼ã¯ã€Œ${k}ï¼ˆ${r}ï¼‰ã€ã§ã—ãŸğŸ¾`
        : `çŒ«ã®ã‚«ãƒ­ãƒªãƒ¼ã‚’è¨ˆç®—ã—ã¾ã—ãŸğŸ¾`;

      if (navigator.share){
        const btnShare = document.createElement('button');
        btnShare.className='share-item';
        btnShare.innerHTML = iconShare() + '<span>ã“ã®çµæœã‚’å…±æœ‰</span>';
        btnShare.addEventListener('click', async () => {
          try { await navigator.share({ title: 'çŒ«ã®ã‚«ãƒ­ãƒªãƒ¼è¨ˆç®—', text, url }); } catch(e){}
          toggleShare(false);
        });
        shareMenu.appendChild(btnShare);
      }

      const btnX = document.createElement('a');
      btnX.className='share-item';
      btnX.href = `https://x.com/intent/post?${new URLSearchParams({url, text}).toString()}`;
      btnX.target = '_blank'; btnX.rel='noopener';
      btnX.innerHTML = iconX() + '<span>Xã§ã‚·ã‚§ã‚¢</span>';
      btnX.addEventListener('click', ()=> toggleShare(false));
      shareMenu.appendChild(btnX);

      const btnCopy = document.createElement('button');
      btnCopy.className='share-item';
      btnCopy.innerHTML = iconLink() + '<span>ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼</span>';
      btnCopy.addEventListener('click', async () => {
        await navigator.clipboard.writeText(url);
        showToast('ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');
        toggleShare(false);
      });
      shareMenu.appendChild(btnCopy);
    }
    function toggleShare(open){
      if (typeof open === 'undefined') open = !shareMenu.classList.contains('open');
      shareMenu.classList.toggle('open', open);
      shareBtn.setAttribute('aria-expanded', String(open));
      if (open) buildShareMenu();
    }

    // ===== è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ç‰ˆï¼šä¸­å¿ƒå€¤ï¼‹å‚è€ƒå¹…ï¼‰ =====
    function RER(weight){ return 70 * Math.pow(weight, 0.75); }

    // ã‚¹ãƒ†ãƒ¼ã‚¸/ç›®æ¨™/å»å‹¢ ã‹ã‚‰ ä¿‚æ•°ã®ä¸­å¿ƒå€¤ã¨å¹…ï¼ˆmin,maxï¼‰ã‚’è¿”ã™
    function pickFactorSimple(stage, goal, neutered){
      // goalãŒæœ€å„ªå…ˆï¼ˆæ¸›é‡/å¢—é‡ï¼‰
      if (goal === 'loss')   return {center:0.85, min:0.8, max:1.0, label:'æ¸›é‡ã®ç›®å®‰'};
      if (goal === 'gain')   return {center:1.3,  min:1.2, max:1.4, label:'å¢—é‡ã®ç›®å®‰'};
      // ç¶­æŒ
      if (stage === 'kitten') return {center:2.5, min:2.0, max:3.0, label:'å­çŒ«ã®æˆé•·'};
      if (stage === 'senior') return {center:1.2, min:1.1, max:1.4, label:'ã‚·ãƒ‹ã‚¢ã®ç›®å®‰'};
      // æˆçŒ«
      if (neutered) return {center:1.2, min:1.0, max:1.6, label:'æˆçŒ«ãƒ»å»å‹¢/é¿å¦Šæ¸ˆ'};
      return {center:1.4, min:1.2, max:1.6, label:'æˆçŒ«ãƒ»æœªå»å‹¢/æœªé¿å¦Š'};
    }

    // çŠ¶æ…‹
    const state = {
      stage: 'adult',    // 'kitten'|'adult'|'senior'
      goal:  'maintain', // 'maintain'|'loss'|'gain'
      neutered: true
    };

    function setSegPressed(list, target){
      list.forEach(btn => btn.setAttribute('aria-pressed', String(btn === target)));
    }
    function applyNeuteredVisibility(){
      const show = (state.stage === 'adult');
      neuteredWrap.hidden = !show;
      neutered.disabled = !show;
    }

    // ã‚¤ãƒ™ãƒ³ãƒˆ
    segStageBtns.forEach(btn=>{
      btn.addEventListener('click', ()=>{
        state.stage = btn.dataset.stage;
        setSegPressed(segStageBtns, btn);
        applyNeuteredVisibility();
        update();
      });
    });
    segGoalBtns.forEach(btn=>{
      btn.addEventListener('click', ()=>{
        state.goal = btn.dataset.goal;
        setSegPressed(segGoalBtns, btn);
        update();
      });
    });
    neutered.addEventListener('change', ()=>{ state.neutered = neutered.checked; update(); });

    // URLå¾©å…ƒ
    (function restore(){
      const p = new URLSearchParams(location.search);
      if (p.get('w')) w.value = p.get('w');
      if (p.get('s')) {
        state.stage = p.get('s');
        const b=[...segStageBtns].find(x=>x.dataset.stage===state.stage);
        if (b) setSegPressed(segStageBtns,b);
      }
      if (p.get('g')) {
        state.goal  = p.get('g');
        const b=[...segGoalBtns].find(x=>x.dataset.goal===state.goal);
        if (b) setSegPressed(segGoalBtns,b);
      }
      if (p.get('n')) {
        state.neutered = (p.get('n')==='1');
        neutered.checked = state.neutered;
      }
      applyNeuteredVisibility();
      update();
    })();

    // å…¥åŠ›ã‚¤ãƒ™ãƒ³ãƒˆ
    w.addEventListener('input', update);

    // è¨ˆç®— & åæ˜ 
    function update(){
      errEl.textContent = '';
      const weight = parseFloat(w.value);
      if (!(weight>0)) { setResult('--','â€”','â€”','â€”'); syncURL(); return; }
      if (weight < 0.5 || weight > 12) errEl.textContent = 'ä½“é‡ãŒä¸€èˆ¬çš„ãªç¯„å›²ã‚’å¤–ã‚Œã¦ã„ã¾ã™ï¼ˆ0.5ã€œ12kgç›®å®‰ï¼‰ã€‚çµæœã¯ã‚ãã¾ã§å‚è€ƒã«ã€‚';

      const rer = RER(weight);
      const f = pickFactorSimple(state.stage, state.goal, state.neutered);
      const center = rer * f.center;
      const min    = rer * f.min;
      const max    = rer * f.max;

      setResult(
        round1(center)+'',
        `${round1(min)}ã€œ${round1(max)} kcal/æ—¥`,
        `Ã— ${f.center.toFixed(2)}ï¼ˆ${f.label}ï¼‰`,
        noteFor(state)
      );
      syncURL();
    }

    function setResult(kcal, range, factor, note){
      kcalEl.textContent = kcal;
      rangeEl.textContent = range;
      factorEl.textContent = factor;
      noteEl.textContent = note;
    }
    function noteFor(s){
      if (s.goal==='loss') return 'æ¸›é‡ã¯ã‚†ã£ãã‚ŠãŒå®‰å…¨ã€‚1ã€œ2é€±ã”ã¨ã«ä½“é‡ã‚’ç¢ºèªã—ã€ä¸ãˆã‚‹é‡ã‚’5ã€œ10%ãšã¤èª¿æ•´ã—ã¾ã—ã‚‡ã†ã€‚';
      if (s.goal==='gain') return 'å¢—é‡ã¯ä½“èª¿ã‚’è¦‹ãªãŒã‚‰å°‘ã—ãšã¤ã€‚é£Ÿæ¬²ã‚„æ´»å‹•é‡ã®å¤‰åŒ–ã‚‚ä½µã›ã¦ç¢ºèªã‚’ã€‚';
      if (s.stage==='kitten') return 'å­çŒ«ã¯æœˆé½¢ã§å¿…è¦é‡ãŒå¤‰ã‚ã‚Šã¾ã™ã€‚æœˆé½¢ãŒé€²ã‚€ã«ã¤ã‚Œã¦å°‘ã—ãšã¤æ¸›ã‚‰ã—ã¦ã„ãã¾ã™ã€‚';
      if (s.stage==='senior') return 'ã‚·ãƒ‹ã‚¢ã¯å€‹ä½“å·®ãŒå¤§ãã„æ™‚æœŸã€‚ä½“é‡ãƒ»é£Ÿæ¬²ãƒ»é£²æ°´ã‚’ã“ã¾ã‚ã«è¦³å¯Ÿã—ã¾ã—ã‚‡ã†ã€‚';
      return 'ã¾ãšã¯ä¸­å¿ƒå€¤ã§å§‹ã‚ã€é€±1ã€œ2å›ã®ä½“é‡è¨˜éŒ²ã§5ã€œ10%ãšã¤å¾®èª¿æ•´ã™ã‚‹ã®ãŒãŠã™ã™ã‚ã€‚';
    }
    function round1(x){ return Math.round(x*10)/10; }
    function syncURL(){
      const url = new URL(location.href);
      url.searchParams.set('w', w.value || '');
      url.searchParams.set('s', state.stage);
      url.searchParams.set('g', state.goal);
      url.searchParams.set('n', state.neutered ? '1':'0');
      history.replaceState(null,'',url);
    }

    // å…±æœ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼
    function buildShareMenu(){
      shareMenu.innerHTML = '';
      const url = new URL(location.href).toString();
      const k = kcalEl.textContent;
      const r = rangeEl.textContent;
      const text = (k !== '--' && r !== 'â€”')
        ? `ã†ã¡ã®çŒ«ã®å¿…è¦ã‚«ãƒ­ãƒªãƒ¼ã¯ã€Œ${k}ï¼ˆ${r}ï¼‰ã€ã§ã—ãŸğŸ¾`
        : `çŒ«ã®ã‚«ãƒ­ãƒªãƒ¼ã‚’è¨ˆç®—ã—ã¾ã—ãŸğŸ¾`;

      if (navigator.share){
        const btnShare = document.createElement('button');
        btnShare.className='share-item';
        btnShare.innerHTML = iconShare() + '<span>ã“ã®çµæœã‚’å…±æœ‰</span>';
        btnShare.addEventListener('click', async () => {
          try { await navigator.share({ title: 'çŒ«ã®ã‚«ãƒ­ãƒªãƒ¼è¨ˆç®—', text, url }); } catch(e){}
          toggleShare(false);
        });
        shareMenu.appendChild(btnShare);
      }

      const btnX = document.createElement('a');
      btnX.className='share-item';
      btnX.href = `https://x.com/intent/post?${new URLSearchParams({url, text}).toString()}`;
      btnX.target = '_blank'; btnX.rel='noopener';
      btnX.innerHTML = iconX() + '<span>Xã§ã‚·ã‚§ã‚¢</span>';
      btnX.addEventListener('click', ()=> toggleShare(false));
      shareMenu.appendChild(btnX);

      const btnCopy = document.createElement('button');
      btnCopy.className='share-item';
      btnCopy.innerHTML = iconLink() + '<span>ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼</span>';
      btnCopy.addEventListener('click', async () => {
        await navigator.clipboard.writeText(url);
        showToast('ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');
        toggleShare(false);
      });
      shareMenu.appendChild(btnCopy);
    }
    function toggleShare(open){
      if (typeof open === 'undefined') open = !shareMenu.classList.contains('open');
      shareMenu.classList.toggle('open', open);
      shareBtn.setAttribute('aria-expanded', String(open));
      if (open) buildShareMenu();
    }

    // åˆæœŸæç”»
    applyNeuteredVisibility();
    update();
  </script>
</body>
</html>
