<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>猫の給餌量計算｜1日の必要カロリーから与える目安量を自動計算</title>
  <meta name="description" content="1日の必要カロリーとフードのカロリー密度（kcal/100g）を入れるだけで、1日に与える目安量（g）と朝・夜に分けた1回量を自動計算します。">
  <link rel="canonical" href="https://cat-tools.catnote.tokyo/calculate-cat-feeding">

  <!-- OGP（必要に応じて差し替え） -->
  <meta property="og:title" content="猫の給餌量計算｜与える目安量を自動計算">
  <meta property="og:description" content="必要カロリーとkcal/100gから、1日量と朝夜の1回量を自動計算。">
  <meta property="og:type" content="website">

  <!-- Fonts（前回同様） -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Zen+Kaku+Gothic+New:wght@400..700&family=Outfit:wght@600;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --primary:#FF69B4;
      --primary-strong:#E00070;
      --border:#E9E9EA;
      --text:#111;
      --muted:#666;
      --r-sm:8px; --r-md:12px; --r-lg:16px; --r-xl:24px;
      --s-1:8px; --s-2:16px; --s-3:24px; --s-4:40px;
      --ring:0 0 0 2px rgba(224,0,112,.35);
    }
    *,*::before,*::after{ box-sizing:border-box }
    html,body{ height:100% }
    body{
      margin:0; background:#fff; color:var(--text);
      font-family:"Zen Kaku Gothic New","Noto Sans JP",-apple-system,system-ui,Segoe UI,Meiryo,sans-serif;
      -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    }
    .container{ max-width:760px; margin:0 auto; padding:0 var(--s-3) var(--s-4) }

    .eyebrow{ font-size:14px; letter-spacing:.08em; text-transform:uppercase; color:rgba(224,0,112,.85); margin-top:var(--s-3) }
    h1{ font-size:32px; line-height:1.25; font-weight:700; margin:.4rem 0 0 }
    @media (min-width:768px){ h1{ font-size:40px; line-height:1.2 } }
    .lead{ font-size:14px; color:var(--muted); margin:.6rem 0 var(--s-3); line-height:1.7 }
    .section{ margin-top:var(--s-4) }

    /* 入力セクション：下線で区切り */
    .surface{
      padding:var(--s-3);
      border-bottom:1px solid var(--border);
    }
    .label{ font-size:18px; font-weight:700 }
    .row{ display:flex; flex-direction:column; gap:var(--s-2); margin-top:var(--s-2) }
    .field{ display:flex; flex-direction:column; gap:6px }

    input[type="number"]{
      height:56px; width:100%;
      border:2px solid #F0C7D8; border-radius:var(--r-xl);
      background:#fff; color:var(--text);
      padding:0 var(--s-3); font-size:16px;
    }
    input:focus-visible{ outline:none; box-shadow:var(--ring) }

    .help{ font-size:13px; color:#808080 }
    .warn{ font-size:13px; color:#b00020; min-height:1.2em }

    /* 結果 */
    .result{ padding-top:var(--s-3); border-bottom:1px solid var(--border) }
    .result .muted{ color:var(--muted); font-size:12px; letter-spacing:.04em }
    .numeral{
      font-family:"Outfit",ui-sans-serif,system-ui,-apple-system,"Helvetica Neue",Arial,sans-serif;
      font-variant-numeric:tabular-nums; letter-spacing:-.01em;
    }
    .big{ text-align:center; margin-top:8px }
    .big .val{ font-size:56px; font-weight:800; color:var(--primary-strong) }
    .big .unit{ font-size:18px; color:#111; position:relative; top:-10px; margin-left:6px }
    @media (min-width:768px){
      .big .val{ font-size:72px }
      .big .unit{ font-size:20px; top:-12px }
    }
    .split{ text-align:center; margin-top:10px; font-size:16px; font-weight:700 }
    .note{ text-align:center; margin-top:10px; font-size:13px; color:#777 }

    /* FAQ風 提示（任意で消してOK） */
    .tips{ margin-top:var(--s-3); color:#555; font-size:14px }
    .tips li{ margin:6px 0 }

    footer{ color:#888; font-size:13px; margin-top:var(--s-4) }
    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0 }
  </style>
</head>
<body>
  <main class="container">
    <!-- Hero -->
    <section class="section">
      <p class="eyebrow">必要カロリーから与える量を計算</p>
      <h1>猫の給餌量計算</h1>
      <p class="lead">1日の必要カロリーと、フードのカロリー密度（kcal/100g）から、<br>与える目安量を自動計算します。朝・夜に分けた1回量も表示します。</p>

      <div class="surface">
        <div class="label">入力</div>
        <div class="row">
          <div class="field">
            <label for="kcalInput">1日の必要カロリー（kcal）</label>
            <input id="kcalInput" type="number" inputmode="decimal" placeholder="例：230" aria-describedby="kcalHelp kcalWarn">
            <div id="kcalHelp" class="help">カロリー計算ツールの結果を入力。URLの <code>?kcal=230</code> から自動入力も可能です。</div>
            <div id="kcalWarn" class="warn" aria-live="polite"></div>
          </div>

          <div class="field">
            <label for="densityInput">フードのカロリー密度（kcal/100g）</label>
            <input id="densityInput" type="number" inputmode="decimal" placeholder="例：390" aria-describedby="densityHelp densityWarn">
            <div id="densityHelp" class="help">パッケージやメーカーサイトにある「代謝エネルギー：◯◯kcal/100g」を入力してください。</div>
            <div id="densityWarn" class="warn" aria-live="polite"></div>
          </div>

          <div class="help">
            必要カロリーが分からない方は
            <a href="/calculate-cat-calorie" style="color:var(--primary-strong); font-weight:700">こちら（カロリー計算ツール）</a>
          </div>
        </div>
      </div>
    </section>

    <!-- Result -->
    <section class="section" aria-live="polite">
      <div class="result">
        <div class="muted">1日に与える目安量</div>
        <div class="big">
          <span id="dailyGram" class="numeral val">--</span>
          <span class="unit">g</span>
        </div>

        <div id="perMeal" class="split">朝 -- g / 夜 -- g</div>
        <div id="note" class="note">※あくまで目安です。猫の体型や活動量に合わせて少しずつ調整してください。</div>

        <ul class="tips">
          <li>例）kcal=230、密度=390 の場合 → 1日 ≈ 59 g（朝30g / 夜29g）</li>
          <li>数値は四捨五入。合計の端数は朝側で調整します。</li>
        </ul>
      </div>
    </section>

    <footer class="section">© <span id="year"></span> CAT LINK tools</footer>
  </main>

  <script>
    // ===== ユーティリティ =====
    const $ = (s)=>document.querySelector(s);
    $('#year').textContent = String(new Date().getFullYear());

    // 入力
    const kcalInput = $('#kcalInput');
    const densityInput = $('#densityInput');

    // 警告
    const kcalWarn = $('#kcalWarn');
    const densityWarn = $('#densityWarn');

    // 出力
    const dailyGramEl = $('#dailyGram');
    const perMealEl = $('#perMeal');

    // 推奨レンジ
    const RANGE = {
      kcal: {min:50, max:1000},
      density: {min:50, max:600}
    };

    // 正規化
    function normalizeNumberInput(s){
      if (s == null) return null;
      const n = Number(String(s).replace(/,/g,'').trim());
      return Number.isFinite(n) ? n : null;
    }

    // 計算
    function calcGramsPerDay(dailyKcal, kcalPer100g){
      if (!(dailyKcal>0) || !(kcalPer100g>0)) return null;
      return (dailyKcal / kcalPer100g) * 100;
    }
    function splitMorningNight(total){
      const totalInt = Math.round(total);
      const morning = Math.round(totalInt / 2);
      const night = totalInt - morning; // 合計ズレは朝側で吸収
      return { morning, night, totalInt };
    }

    // URL 初期化
    (function restoreFromQuery(){
      const p = new URLSearchParams(location.search);
      if (p.get('kcal')) kcalInput.value = p.get('kcal');
      if (p.get('d')) densityInput.value = p.get('d');
      update();
    })();

    // URL 同期
    function syncURL(){
      const url = new URL(location.href);
      const k = kcalInput.value || '';
      const d = densityInput.value || '';
      if (k) url.searchParams.set('kcal', k); else url.searchParams.delete('kcal');
      if (d) url.searchParams.set('d', d); else url.searchParams.delete('d');
      history.replaceState(null,'',url);
    }

    // バリデーション表示（注意のみ、ブロックしない）
    function renderWarnings(kcal, density){
      kcalWarn.textContent = '';
      densityWarn.textContent = '';

      if (kcal!=null && (kcal < RANGE.kcal.min || kcal > RANGE.kcal.max)){
        kcalWarn.textContent = `目安の範囲（${RANGE.kcal.min}〜${RANGE.kcal.max}kcal/日）から外れています。結果は参考としてご利用ください。`;
      }
      if (density!=null && (density < RANGE.density.min || density > RANGE.density.max)){
        densityWarn.textContent = `目安の範囲（${RANGE.density.min}〜${RANGE.density.max}kcal/100g）から外れています。結果は参考としてご利用ください。`;
      }
    }

    // 描画
    function renderResult(total){
      if (total==null){
        dailyGramEl.textContent = '--';
        perMealEl.textContent = '朝 -- g / 夜 -- g';
        return;
      }
      const { morning, night, totalInt } = splitMorningNight(total);
      dailyGramEl.textContent = String(totalInt);
      perMealEl.textContent = `朝 ${morning} g / 夜 ${night} g`;
    }

    // メイン更新
    function update(){
      const kcal = normalizeNumberInput(kcalInput.value);
      const density = normalizeNumberInput(densityInput.value);

      renderWarnings(kcal, density);

      if (!(kcal>0) || !(density>0)){
        renderResult(null);
        syncURL();
        return;
      }

      const grams = calcGramsPerDay(kcal, density);
      renderResult(grams);
      syncURL();
    }

    // イベント
    kcalInput.addEventListener('input', update);
    densityInput.addEventListener('input', update);
  </script>
</body>
</html>
